# æœåŠ¡å™¨éƒ¨ç½²

> **æ–¹æ³•è®º**: éƒ¨ç½²ä¸æ˜¯ç„å­¦,ç†è§£æ¶æ„åŸç†å,æ‰€æœ‰é—®é¢˜éƒ½èƒ½è¿åˆƒè€Œè§£ã€‚

---

## ğŸ“– æœ¬èŠ‚ç›®æ ‡

å­¦å®Œæœ¬èŠ‚,ä½ å°†ç†è§£:
- âœ… äº‘æœåŠ¡å™¨å’Œå®‰å…¨ç»„é…ç½®
- âœ… Nginxåå‘ä»£ç†çš„åŸç†å’Œé…ç½®
- âœ… PM2è¿›ç¨‹ç®¡ç†å™¨çš„ä½¿ç”¨
- âœ… HTTPSè¯ä¹¦é…ç½®
- âœ… åŸŸåè§£æå’ŒDNSé…ç½®

**é¢„è®¡ç”¨æ—¶**: 40åˆ†é’Ÿ

---

## 1. éƒ¨ç½²æ¶æ„å…¨æ™¯å›¾

### 1.1 ä»ç”¨æˆ·è®¿é—®åˆ°æœåŠ¡å™¨å“åº”

```
ç”¨æˆ·æµè§ˆå™¨ www.yoursite.com
    â”‚
    â–¼
åŸŸåè§£æ(DNS)  â†’ å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€
    â”‚
    â–¼
äº‘æœåŠ¡å™¨å®‰å…¨ç»„  â†’ é˜²ç«å¢™,æ£€æŸ¥æ˜¯å¦å…è®¸è®¿é—®
    â”‚
    â–¼
Nginxåå‘ä»£ç†  â†’ å‰å°æ¥å¾…å‘˜,è·¯ç”±è¯·æ±‚
    â”‚
    â”œâ”€â†’ é™æ€æ–‡ä»¶  â†’ ç›´æ¥è¿”å›HTML/CSS/JS
    â”‚
    â””â”€â†’ åç«¯API  â†’ PM2ç®¡ç†çš„Node.js/Pythonåº”ç”¨
           â”‚
           â””â”€â†’ æ•°æ®åº“  â†’ è¯»å–/å†™å…¥æ•°æ®
```

### 1.2 æ ¸å¿ƒæ¦‚å¿µç±»æ¯”

| ç»„ä»¶ | ç”Ÿæ´»ç±»æ¯” | ä½œç”¨ |
|------|---------|------|
| **äº‘æœåŠ¡å™¨** | å•†åœºå¤§æ¥¼ | 24å°æ—¶è¥ä¸šçš„ç”µè„‘ |
| **å®‰å…¨ç»„/é˜²ç«å¢™** | é—¨ç¦ç³»ç»Ÿ | æ§åˆ¶è°èƒ½è¿›æ¥ |
| **åŸŸå** | å•†åœºåœ°å€ | www.yoursite.com |
| **DNS** | å¯¼èˆªåœ°å›¾ | åŸŸåâ†’IPåœ°å€ |
| **Nginx** | å‰å°æ¥å¾… | åˆ†æµè®¿å®¢åˆ°ä¸åŒéƒ¨é—¨ |
| **PM2** | éƒ¨é—¨ç»ç† | ç®¡ç†å‘˜å·¥(è¿›ç¨‹),è‡ªåŠ¨é‡å¯ |
| **åº”ç”¨è¿›ç¨‹** | å‘˜å·¥ | å¤„ç†å…·ä½“ä¸šåŠ¡ |

---

## 2. äº‘æœåŠ¡å™¨å’Œå®‰å…¨ç»„

### 2.1 ä»€ä¹ˆæ˜¯äº‘æœåŠ¡å™¨?

**äº‘æœåŠ¡å™¨ = è¿œç¨‹çš„24å°æ—¶å¼€æœºç”µè„‘**

| ä½ çš„ç¬”è®°æœ¬ | äº‘æœåŠ¡å™¨ |
|-----------|---------|
| åœ¨ä½ å®¶é‡Œ | åœ¨æœºæˆ¿é‡Œ |
| ä½ å…³æœºå°±åœæ­¢ | 24å°æ—¶ä¸åœæœº |
| åªæœ‰ä½ èƒ½è®¿é—® | å…¨ä¸–ç•Œéƒ½èƒ½è®¿é—®(å¦‚æœé…ç½®æ­£ç¡®) |
| æ–­ç½‘å°±ç”¨ä¸äº† | å¤šæ¡ç½‘ç»œçº¿è·¯,é«˜å¯ç”¨ |

### 2.2 å®‰å…¨ç»„é…ç½® âš ï¸ æ–°æ‰‹å¿…çœ‹!

**æœ€å¸¸è§çš„éƒ¨ç½²å¤±è´¥åŸå› **: å¿˜è®°é…ç½®å®‰å…¨ç»„!

**å®‰å…¨ç»„ = äº‘æœåŠ¡å™¨çš„é—¨ç¦ç³»ç»Ÿ**

```
                     äº‘å®‰å…¨ç»„
ç”¨æˆ· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ç«¯å£80?  å…è®¸â”‚ â”€â”€â”€â”€> Nginx
                    â”‚ç«¯å£443? å…è®¸â”‚
                    â”‚ç«¯å£3000? æ‹’ç»â”‚ âœ—  ä½ çš„åº”ç”¨è®¿é—®ä¸äº†!
```

### 2.3 å¿…é¡»å¼€æ”¾çš„ç«¯å£

| ç«¯å£ | åè®® | ç”¨é€” | æ˜¯å¦å¿…éœ€ |
|------|------|------|---------|
| 22 | SSH | è¿œç¨‹ç™»å½•æœåŠ¡å™¨ | âœ… å¿…éœ€ |
| 80 | HTTP | ç½‘ç«™è®¿é—®(HTTP) | âœ… å¿…éœ€ |
| 443 | HTTPS | ç½‘ç«™è®¿é—®(HTTPS) | âœ… å¼ºçƒˆæ¨è |
| 3000/8000 | è‡ªå®šä¹‰ | åº”ç”¨ç›´æ¥è®¿é—® | âŒ ä¸æ¨èæš´éœ² |

### 2.4 é…ç½®å®‰å…¨ç»„(å„äº‘å¹³å°)

**é˜¿é‡Œäº‘**:
1. ç™»å½•æ§åˆ¶å°
2. äº‘æœåŠ¡å™¨ECS â†’ ç½‘ç»œä¸å®‰å…¨ â†’ å®‰å…¨ç»„
3. é…ç½®è§„åˆ™ â†’ æ·»åŠ å…¥æ–¹å‘è§„åˆ™
4. æ·»åŠ ç«¯å£: 22, 80, 443

**è…¾è®¯äº‘**:
1. ç™»å½•æ§åˆ¶å°
2. äº‘æœåŠ¡å™¨ â†’ å®‰å…¨ç»„ â†’ ä¿®æ”¹è§„åˆ™
3. å…¥ç«™è§„åˆ™ â†’ æ·»åŠ è§„åˆ™
4. æ·»åŠ ç«¯å£: 22, 80, 443

**AWS**:
1. EC2 â†’ Security Groups
2. Edit inbound rules
3. Add Rule â†’ æ·»åŠ ç«¯å£

**éªŒè¯é…ç½®**:

```bash
# åœ¨æœ¬åœ°æµ‹è¯•ç«¯å£æ˜¯å¦å¼€æ”¾
telnet your-server-ip 80
telnet your-server-ip 443

# æˆ–ä½¿ç”¨curl
curl http://your-server-ip
```

---

## 3. Nginxåå‘ä»£ç†

### 3.1 ä¸ºä»€ä¹ˆéœ€è¦Nginx?

**åœºæ™¯**: ä½ æœ‰ä¸€ä¸ªå‰ç«¯(React)å’Œä¸€ä¸ªåç«¯(Node.js)

**ä¸ç”¨Nginxçš„é—®é¢˜**:

```
å‰ç«¯: http://your-ip:3000   â† ç”¨æˆ·è¦è®°ç«¯å£
åç«¯: http://your-ip:8000   â† ä¸¤ä¸ªåœ°å€,è·¨åŸŸé—®é¢˜
```

**ç”¨Nginxå**:

```
ç”¨æˆ·è®¿é—®: https://www.yoursite.com

Nginxè‡ªåŠ¨åˆ†æµ:
- www.yoursite.com/      â†’ å‰ç«¯é™æ€æ–‡ä»¶
- www.yoursite.com/api/  â†’ åç«¯API

ä¸€ä¸ªåŸŸå,æ— è·¨åŸŸ! âœ…
```

### 3.2 Nginxçš„ä¸‰å¤§ä½œç”¨

| ä½œç”¨ | è¯´æ˜ | ç±»æ¯” |
|------|------|------|
| **åå‘ä»£ç†** | éšè—çœŸå®æœåŠ¡å™¨,ç»Ÿä¸€å…¥å£ | å‰å°æ¥å¾…,åˆ†æµè®¿å®¢ |
| **è´Ÿè½½å‡è¡¡** | åˆ†å‘è¯·æ±‚åˆ°å¤šä¸ªæœåŠ¡å™¨ | å¼€å¤šä¸ªçª—å£,æ’é˜Ÿå‡åŒ€ |
| **é™æ€èµ„æºæœåŠ¡** | é«˜æ•ˆæä¾›HTML/CSS/JS | è‡ªåŠ©æœåŠ¡åŒº,ä¸ç”¨éº»çƒ¦åå¨ |

### 3.3 å®‰è£…Nginx

**Ubuntu/Debian**:

```bash
sudo apt update
sudo apt install nginx

# å¯åŠ¨Nginx
sudo systemctl start nginx

# å¼€æœºè‡ªå¯
sudo systemctl enable nginx

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status nginx
```

**CentOS/RHEL**:

```bash
sudo yum install nginx

sudo systemctl start nginx
sudo systemctl enable nginx
```

**éªŒè¯å®‰è£…**:

æ‰“å¼€æµè§ˆå™¨,è®¿é—® `http://your-server-ip`

çœ‹åˆ°"Welcome to nginx!"è¯´æ˜æˆåŠŸ!

### 3.4 Nginxé…ç½®æ–‡ä»¶

**ä¸»é…ç½®æ–‡ä»¶ä½ç½®**:

```bash
# Ubuntu/Debian
/etc/nginx/nginx.conf
/etc/nginx/sites-available/default

# CentOS/RHEL
/etc/nginx/nginx.conf
/etc/nginx/conf.d/default.conf
```

**åŸºç¡€é…ç½®ç¤ºä¾‹**:

```nginx
# /etc/nginx/sites-available/mysite

server {
    listen 80;                          # ç›‘å¬80ç«¯å£
    server_name www.yoursite.com;       # ä½ çš„åŸŸå

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/mysite/dist;      # å‰ç«¯buildåçš„æ–‡ä»¶å¤¹
        index index.html;
        try_files $uri $uri/ /index.html;  # è§£å†³SPAåˆ·æ–°404
    }

    # åç«¯APIä»£ç†
    location /api/ {
        proxy_pass http://localhost:3000;  # è½¬å‘åˆ°åç«¯
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

**é…ç½®è¯´æ˜**:

| æŒ‡ä»¤ | ä½œç”¨ |
|------|------|
| `listen 80` | ç›‘å¬HTTPè¯·æ±‚(80ç«¯å£) |
| `server_name` | åŸŸåæˆ–IP |
| `location /` | å¤„ç†æ ¹è·¯å¾„è¯·æ±‚ |
| `root` | é™æ€æ–‡ä»¶ç›®å½• |
| `try_files` | SPAåº”ç”¨é˜²404 |
| `proxy_pass` | åå‘ä»£ç†åˆ°åç«¯ |

### 3.5 å¯ç”¨é…ç½®

```bash
# åˆ›å»ºè½¯é“¾æ¥(Ubuntu/Debian)
sudo ln -s /etc/nginx/sites-available/mysite /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®
sudo nginx -t

# é‡è½½é…ç½®
sudo nginx -s reload

# æˆ–é‡å¯Nginx
sudo systemctl restart nginx
```

### 3.6 è§£å†³SPAåˆ·æ–°404é—®é¢˜

**é—®é¢˜**: React/Vueåº”ç”¨åˆ·æ–°é¡µé¢å404

**åŸå› **: Nginxæ‰¾ä¸åˆ°ç‰©ç†æ–‡ä»¶`/about.html`

**è§£å†³**: ä½¿ç”¨`try_files`

```nginx
location / {
    root /var/www/mysite/dist;
    index index.html;
    try_files $uri $uri/ /index.html;  # å…³é”®é…ç½®!
}
```

**åŸç†**: æ‰¾ä¸åˆ°æ–‡ä»¶æ—¶,è¿”å›`index.html`,è®©å‰ç«¯è·¯ç”±å¤„ç†

---

## 4. PM2è¿›ç¨‹ç®¡ç†

### 4.1 ä¸ºä»€ä¹ˆéœ€è¦PM2?

**é—®é¢˜**: ç›´æ¥è¿è¡Œ`node app.js`

```bash
node app.js
# ç¨‹åºå´©æºƒäº† â†’ åº”ç”¨åœæ­¢! âœ—
# å…³é—­ç»ˆç«¯ â†’ åº”ç”¨åœæ­¢! âœ—
# æœåŠ¡å™¨é‡å¯ â†’ åº”ç”¨ä¸ä¼šè‡ªåŠ¨å¯åŠ¨! âœ—
```

**PM2è§£å†³æ–¹æ¡ˆ**:

- âœ… è‡ªåŠ¨å´©æºƒé‡å¯
- âœ… åå°è¿è¡Œ(å…³é—­ç»ˆç«¯ä¹Ÿä¸åœ)
- âœ… æœåŠ¡å™¨é‡å¯åè‡ªåŠ¨å¯åŠ¨
- âœ… é›†ç¾¤æ¨¡å¼(å¤šæ ¸CPUåˆ©ç”¨)
- âœ… æ—¥å¿—ç®¡ç†
- âœ… é›¶åœæœºéƒ¨ç½²

### 4.2 å®‰è£…PM2

```bash
# å…¨å±€å®‰è£…PM2
sudo npm install -g pm2

# éªŒè¯å®‰è£…
pm2 --version
```

### 4.3 PM2åŸºç¡€å‘½ä»¤

**å¯åŠ¨åº”ç”¨**:

```bash
# å¯åŠ¨åº”ç”¨
pm2 start app.js --name my-app

# å¯åŠ¨Pythonåº”ç”¨
pm2 start app.py --interpreter python3

# é›†ç¾¤æ¨¡å¼(åˆ©ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ)
pm2 start app.js -i max
```

**ç®¡ç†åº”ç”¨**:

```bash
# æŸ¥çœ‹æ‰€æœ‰åº”ç”¨
pm2 list
pm2 status

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show my-app

# æŸ¥çœ‹æ—¥å¿—
pm2 logs my-app

# å®æ—¶ç›‘æ§
pm2 monit
```

**é‡å¯å’Œåœæ­¢**:

```bash
# é‡å¯åº”ç”¨
pm2 restart my-app

# é‡è½½åº”ç”¨(é›¶åœæœº)
pm2 reload my-app

# åœæ­¢åº”ç”¨
pm2 stop my-app

# åˆ é™¤åº”ç”¨
pm2 delete my-app

# é‡å¯æ‰€æœ‰åº”ç”¨
pm2 restart all
```

### 4.4 å¼€æœºè‡ªå¯é…ç½® âš ï¸ é‡è¦!

**å¿…é¡»æ‰§è¡Œçš„ä¸¤ä¸ªå‘½ä»¤**:

```bash
# 1. ç”Ÿæˆå¯åŠ¨è„šæœ¬
pm2 startup

# ä¼šè¾“å‡ºç±»ä¼¼è¿™æ ·çš„å‘½ä»¤,å¤åˆ¶æ‰§è¡Œ:
# sudo env PATH=$PATH:/usr/bin pm2 startup systemd -u username --hp /home/username

# 2. ä¿å­˜å½“å‰åº”ç”¨åˆ—è¡¨
pm2 save
```

**ä¸ºä»€ä¹ˆä¸¤ä¸ªéƒ½è¦?**

- `pm2 startup`: è®©ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨PM2
- `pm2 save`: å‘Šè¯‰PM2å¯åŠ¨æ—¶è¦è¿è¡Œå“ªäº›åº”ç”¨

**éªŒè¯**:

```bash
# é‡å¯æœåŠ¡å™¨
sudo reboot

# é‡æ–°ç™»å½•åæ£€æŸ¥
pm2 list
# ä½ çš„åº”ç”¨åº”è¯¥è‡ªåŠ¨è¿è¡Œäº†!
```

### 4.5 ä½¿ç”¨ecosystem.config.js

**åˆ›å»ºé…ç½®æ–‡ä»¶**:

```bash
pm2 init
```

**ç¼–è¾‘ecosystem.config.js**:

```javascript
module.exports = {
  apps: [
    {
      name: 'my-app',                    // åº”ç”¨åç§°
      script: './server.js',             // å¯åŠ¨æ–‡ä»¶
      instances: 2,                      // è¿›ç¨‹æ•°é‡(æˆ–'max')
      exec_mode: 'cluster',              // é›†ç¾¤æ¨¡å¼
      env: {                             // ç¯å¢ƒå˜é‡
        NODE_ENV: 'development',
        PORT: 3000
      },
      env_production: {
        NODE_ENV: 'production',
        PORT: 8000
      },
      error_file: './logs/err.log',     // é”™è¯¯æ—¥å¿—
      out_file: './logs/out.log',       // è¾“å‡ºæ—¥å¿—
      log_date_format: 'YYYY-MM-DD HH:mm:ss',
      merge_logs: true,
      autorestart: true,                 // è‡ªåŠ¨é‡å¯
      watch: false,                      // æ–‡ä»¶å˜åŒ–é‡å¯(å¼€å‘ç”¨)
      max_memory_restart: '1G'           // å†…å­˜è¶…é™é‡å¯
    }
  ]
};
```

**ä½¿ç”¨é…ç½®æ–‡ä»¶**:

```bash
# å¯åŠ¨
pm2 start ecosystem.config.js

# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
pm2 start ecosystem.config.js --env production

# æ›´æ–°é…ç½®åé‡å¯
pm2 restart ecosystem.config.js
```

---

## 5. HTTPSå’ŒSSLè¯ä¹¦

### 5.1 ä¸ºä»€ä¹ˆéœ€è¦HTTPS?

**HTTPçš„é—®é¢˜**:

- âŒ æ•°æ®æ˜æ–‡ä¼ è¾“,å®¹æ˜“è¢«çªƒå¬
- âŒ æµè§ˆå™¨æ˜¾ç¤º"ä¸å®‰å…¨"
- âŒ å°ç¨‹åº/PWAå¿…é¡»HTTPS
- âŒ SEOæ’åæ›´ä½

**HTTPSçš„å¥½å¤„**:

- âœ… æ•°æ®åŠ å¯†ä¼ è¾“
- âœ… æµè§ˆå™¨æ˜¾ç¤ºå®‰å…¨é”
- âœ… æå‡ç”¨æˆ·ä¿¡ä»»
- âœ… SEOæ›´å¥½

### 5.2 ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦

**Let's Encrypt** = å…è´¹ã€è‡ªåŠ¨åŒ–ã€å¼€æ”¾çš„è¯ä¹¦é¢å‘æœºæ„

**å®‰è£…Certbot**:

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install certbot python3-certbot-nginx

# CentOS/RHEL
sudo yum install certbot python3-certbot-nginx
```

**è‡ªåŠ¨é…ç½®Nginx**:

```bash
# Certbotä¼šè‡ªåŠ¨ä¿®æ”¹Nginxé…ç½®
sudo certbot --nginx -d www.yoursite.com -d yoursite.com

# æŒ‰æç¤ºè¾“å…¥é‚®ç®±,åŒæ„åè®®
# é€‰æ‹©æ˜¯å¦é‡å®šå‘HTTPåˆ°HTTPS(æ¨èé€‰Yes)
```

**Certbotåšäº†ä»€ä¹ˆ**:

1. éªŒè¯ä½ æ‹¥æœ‰è¿™ä¸ªåŸŸå
2. ä¸‹è½½SSLè¯ä¹¦
3. è‡ªåŠ¨ä¿®æ”¹Nginxé…ç½®
4. è®¾ç½®HTTPSç›‘å¬
5. è®¾ç½®HTTPâ†’HTTPSé‡å®šå‘

**é…ç½®è‡ªåŠ¨ç»­æœŸ**:

```bash
# Let's Encryptè¯ä¹¦90å¤©è¿‡æœŸ,éœ€è¦è‡ªåŠ¨ç»­æœŸ

# æµ‹è¯•ç»­æœŸ
sudo certbot renew --dry-run

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ(å·²è‡ªåŠ¨é…ç½®,æ— éœ€æ‰‹åŠ¨)
# Certbotä¼šåˆ›å»ºsystemdå®šæ—¶å™¨æˆ–cronä»»åŠ¡
```

**éªŒè¯HTTPS**:

æ‰“å¼€æµè§ˆå™¨,è®¿é—® `https://www.yoursite.com`

çœ‹åˆ°ğŸ”’å®‰å…¨é”,è¯´æ˜æˆåŠŸ!

### 5.3 æ‰‹åŠ¨é…ç½®HTTPS(é«˜çº§)

**å¦‚æœä½¿ç”¨è‡ªå·±çš„è¯ä¹¦**:

```nginx
server {
    listen 443 ssl http2;
    server_name www.yoursite.com;

    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/nginx/ssl/cert.pem;        # è¯ä¹¦
    ssl_certificate_key /etc/nginx/ssl/key.pem;    # ç§é’¥

    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    # å…¶ä»–é…ç½®...
    location / {
        root /var/www/mysite;
        index index.html;
    }
}

# HTTPè‡ªåŠ¨è·³è½¬HTTPS
server {
    listen 80;
    server_name www.yoursite.com;
    return 301 https://$server_name$request_uri;
}
```

---

## 6. åŸŸåå’ŒDNSé…ç½®

### 6.1 åŸŸåè§£æåŸç†

```
ç”¨æˆ·è¾“å…¥: www.yoursite.com
    â”‚
    â–¼
DNSæœåŠ¡å™¨: "è¿™ä¸ªåŸŸåå¯¹åº”IPæ˜¯ 123.45.67.89"
    â”‚
    â–¼
æµè§ˆå™¨è®¿é—®: http://123.45.67.89
```

### 6.2 DNSè®°å½•ç±»å‹

| è®°å½•ç±»å‹ | ä½œç”¨ | ç¤ºä¾‹ |
|---------|------|------|
| **Aè®°å½•** | åŸŸåâ†’IPv4åœ°å€ | `www.yoursite.com â†’ 123.45.67.89` |
| **AAAAè®°å½•** | åŸŸåâ†’IPv6åœ°å€ | `www.yoursite.com â†’ 2001:db8::1` |
| **CNAMEè®°å½•** | åŸŸåâ†’åŸŸå(åˆ«å) | `blog.yoursite.com â†’ www.yoursite.com` |
| **MXè®°å½•** | é‚®ä»¶æœåŠ¡å™¨ | é‚®ç®±ç›¸å…³ |
| **TXTè®°å½•** | æ–‡æœ¬ä¿¡æ¯ | åŸŸåéªŒè¯ |

### 6.3 é…ç½®DNSè§£æ

**å¸¸è§åŸŸåæœåŠ¡å•†**:

- é˜¿é‡Œäº‘(ä¸‡ç½‘)
- è…¾è®¯äº‘DNSPod
- Cloudflare
- GoDaddy
- Namecheap

**é…ç½®æ­¥éª¤** (ä»¥é˜¿é‡Œäº‘ä¸ºä¾‹):

1. ç™»å½•åŸŸåæ§åˆ¶å°
2. æ‰¾åˆ°ä½ çš„åŸŸå â†’ è§£æ
3. æ·»åŠ è®°å½•

**ç¤ºä¾‹é…ç½®**:

| è®°å½•ç±»å‹ | ä¸»æœºè®°å½• | è®°å½•å€¼ | TTL |
|---------|---------|-------|-----|
| A | www | 123.45.67.89 | 600 |
| A | @ | 123.45.67.89 | 600 |
| CNAME | blog | www.yoursite.com | 600 |

**è®°å½•è¯´æ˜**:

- `www`: è®¿é—®www.yoursite.com
- `@`: è®¿é—®yoursite.com(æ ¹åŸŸå)
- `*`: æ³›è§£æ(æ‰€æœ‰å­åŸŸå)

**TTL**: ç¼“å­˜æ—¶é—´(ç§’)
- 600 = 10åˆ†é’Ÿ
- 3600 = 1å°æ—¶

### 6.4 éªŒè¯DNSè§£æ

```bash
# æŸ¥è¯¢åŸŸåçš„Aè®°å½•
nslookup www.yoursite.com

# æˆ–ä½¿ç”¨dig(æ›´è¯¦ç»†)
dig www.yoursite.com

# æŸ¥çœ‹è§£æåˆ°çš„IP
ping www.yoursite.com
```

**DNSç”Ÿæ•ˆæ—¶é—´**: é€šå¸¸5åˆ†é’Ÿåˆ°24å°æ—¶

---

## 7. å®Œæ•´éƒ¨ç½²æµç¨‹

### 7.1 å‰ç«¯æ‰“åŒ…è¯¦è§£

#### 7.1.1 ä¸ºä»€ä¹ˆè¦æ‰“åŒ…?

**æ‰“åŒ… = æŠŠå¼€å‘ä»£ç å˜æˆæµè§ˆå™¨èƒ½é«˜æ•ˆè¿è¡Œçš„ä»£ç **

| å¼€å‘ç¯å¢ƒä»£ç  | ç”Ÿäº§ç¯å¢ƒä»£ç (æ‰“åŒ…å) |
|------------|-------------------|
| å¤šä¸ªJSæ–‡ä»¶ | åˆå¹¶æˆå‡ ä¸ªæ–‡ä»¶ |
| æœ‰æ³¨é‡Šã€æœ‰ç©ºæ ¼ | å‹ç¼©ã€æ··æ·† |
| å®Œæ•´çš„é”™è¯¯æç¤º | æœ€å°åŒ–ä½“ç§¯ |
| React JSXè¯­æ³• | è½¬æ¢æˆçº¯JS |
| ES6+æ–°è¯­æ³• | è½¬æ¢æˆES5å…¼å®¹ä»£ç  |
| å›¾ç‰‡åŸå§‹å¤§å° | å‹ç¼©ä¼˜åŒ– |

**æ‰“åŒ…å‰åå¯¹æ¯”**:

```
å¼€å‘ç¯å¢ƒ:
src/
â”œâ”€â”€ App.jsx           (5KB, JSXè¯­æ³•)
â”œâ”€â”€ Header.jsx        (3KB)
â”œâ”€â”€ Footer.jsx        (2KB)
â”œâ”€â”€ utils.js          (4KB)
â””â”€â”€ ...50ä¸ªæ–‡ä»¶

æ‰“åŒ…å:
dist/
â”œâ”€â”€ index.html        (2KB)
â”œâ”€â”€ main.abc123.js    (120KB, å‹ç¼©æ··æ·†)
â””â”€â”€ main.abc123.css   (15KB, å‹ç¼©)

ä½“ç§¯å‡å°‘60%+, æ–‡ä»¶æ•°é‡å‡å°‘90%+
åŠ è½½é€Ÿåº¦æå‡3-5å€! âš¡
```

#### 7.1.2 æ‰“åŒ…å‰çš„å‡†å¤‡

**æ£€æŸ¥package.jsonçš„scripts**:

```json
{
  "scripts": {
    "dev": "vite",              // å¼€å‘æœåŠ¡å™¨
    "build": "vite build",      // ç”Ÿäº§æ‰“åŒ…
    "preview": "vite preview"   // é¢„è§ˆæ‰“åŒ…ç»“æœ
  }
}
```

**å¸¸è§æ¡†æ¶çš„æ‰“åŒ…å‘½ä»¤**:

| æ¡†æ¶ | æ‰“åŒ…å‘½ä»¤ | è¾“å‡ºç›®å½• |
|------|---------|---------|
| Create React App | `npm run build` | `build/` |
| Vite (React/Vue) | `npm run build` | `dist/` |
| Next.js | `npm run build` | `.next/` |
| Vue CLI | `npm run build` | `dist/` |

#### 7.1.3 ç¯å¢ƒå˜é‡é…ç½®

**ä¸ºä»€ä¹ˆéœ€è¦ç¯å¢ƒå˜é‡?**

å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„APIåœ°å€ä¸åŒ:

```
å¼€å‘: http://localhost:3000/api
ç”Ÿäº§: https://api.yoursite.com/api
```

**åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶**:

```bash
# .env.development (å¼€å‘ç¯å¢ƒ)
VITE_API_URL=http://localhost:3000
VITE_APP_NAME=MyApp Dev

# .env.production (ç”Ÿäº§ç¯å¢ƒ)
VITE_API_URL=https://api.yoursite.com
VITE_APP_NAME=MyApp
```

**åœ¨ä»£ç ä¸­ä½¿ç”¨**:

```javascript
// Viteé¡¹ç›®
const apiUrl = import.meta.env.VITE_API_URL;

// Create React Appé¡¹ç›®
const apiUrl = process.env.REACT_APP_API_URL;
```

**âš ï¸ é‡è¦**:
- ç¯å¢ƒå˜é‡å¿…é¡»ä»¥ `VITE_` æˆ– `REACT_APP_` å¼€å¤´æ‰ä¼šæš´éœ²ç»™å‰ç«¯
- ä¸è¦åœ¨å‰ç«¯ç¯å¢ƒå˜é‡ä¸­å­˜å‚¨å¯†é’¥!

#### 7.1.4 æ‰§è¡Œæ‰“åŒ…

**æ ‡å‡†æ‰“åŒ…æµç¨‹**:

```bash
# 1. å®‰è£…ä¾èµ–(å¦‚æœè¿˜æ²¡è£…)
npm install

# 2. æ‰§è¡Œæ‰“åŒ…
npm run build

# æ‰“åŒ…è¿‡ç¨‹è¾“å‡ºç¤ºä¾‹:
# vite v4.3.0 building for production...
# âœ“ 123 modules transformed.
# dist/index.html                  2.15 kB
# dist/assets/index-abc123.js      142.35 kB â”‚ gzip: 45.23 kB
# dist/assets/index-abc123.css     15.67 kB  â”‚ gzip: 4.12 kB
# âœ“ built in 3.45s

# 3. æ£€æŸ¥æ‰“åŒ…ç»“æœ
ls dist/
# index.html  assets/  favicon.ico
```

**æ‰“åŒ…æˆåŠŸçš„æ ‡å¿—**:

- âœ… æ²¡æœ‰æŠ¥é”™
- âœ… ç”Ÿæˆäº† `dist/` æˆ– `build/` æ–‡ä»¶å¤¹
- âœ… æ–‡ä»¶å¤¹é‡Œæœ‰ `index.html`
- âœ… æœ‰æ‰“åŒ…åçš„ JS å’Œ CSS æ–‡ä»¶

#### 7.1.5 æœ¬åœ°é¢„è§ˆæ‰“åŒ…ç»“æœ

**ä¸ºä»€ä¹ˆè¦é¢„è§ˆ?**

æ‰“åŒ…åçš„ä»£ç å¯èƒ½å’Œå¼€å‘ç¯å¢ƒè¡¨ç°ä¸åŒ,éœ€è¦æœ¬åœ°æµ‹è¯•!

```bash
# Viteé¡¹ç›®
npm run preview
# âœ  Local:   http://localhost:4173/

# æˆ–ä½¿ç”¨http-server
npx http-server dist -p 8080

# æˆ–ä½¿ç”¨serve
npx serve -s dist -p 8080
```

**æ‰“å¼€æµè§ˆå™¨è®¿é—®,æ£€æŸ¥**:
- âœ… é¡µé¢èƒ½æ­£å¸¸æ˜¾ç¤º
- âœ… è·¯ç”±è·³è½¬æ­£å¸¸(SPAåº”ç”¨)
- âœ… APIè¯·æ±‚æ­£å¸¸
- âœ… æ‰“å¼€æ§åˆ¶å°,æ²¡æœ‰é”™è¯¯

#### 7.1.6 å¸¸è§æ‰“åŒ…é”™è¯¯

**é”™è¯¯1: å†…å­˜æº¢å‡º**

```
FATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory
```

**è§£å†³**:

```bash
# å¢åŠ Node.jså†…å­˜é™åˆ¶
NODE_OPTIONS=--max_old_space_size=4096 npm run build
```

---

**é”™è¯¯2: ç¯å¢ƒå˜é‡æœªå®šä¹‰**

```
ReferenceError: process is not defined
```

**åŸå› **: ç›´æ¥ä½¿ç”¨äº† `process.env` è€Œä¸æ˜¯æ¡†æ¶æä¾›çš„æ–¹å¼

**è§£å†³**:

```javascript
// âŒ é”™è¯¯
const apiUrl = process.env.API_URL;

// âœ… æ­£ç¡®(Vite)
const apiUrl = import.meta.env.VITE_API_URL;

// âœ… æ­£ç¡®(CRA)
const apiUrl = process.env.REACT_APP_API_URL;
```

---

**é”™è¯¯3: è·¯å¾„å¼•ç”¨é”™è¯¯**

```
Failed to load resource: net::ERR_FILE_NOT_FOUND
/assets/logo.png 404
```

**åŸå› **: é™æ€èµ„æºè·¯å¾„ä¸å¯¹

**è§£å†³**:

```javascript
// vite.config.js
export default {
  base: '/',  // æˆ– '/your-subpath/'
}

// ç¡®ä¿å›¾ç‰‡æ”¾åœ¨public/æ–‡ä»¶å¤¹
public/
  â””â”€â”€ logo.png

// ä»£ç ä¸­å¼•ç”¨
<img src="/logo.png" />
```

---

**é”™è¯¯4: æ‰“åŒ…ä½“ç§¯è¿‡å¤§**

```
(!) Some chunks are larger than 500kb after minification
```

**è§£å†³ - ä»£ç åˆ†å‰²**:

```javascript
// ä½¿ç”¨åŠ¨æ€å¯¼å…¥
const MyComponent = React.lazy(() => import('./MyComponent'));

// è·¯ç”±æ‡’åŠ è½½
const About = lazy(() => import('./pages/About'));
```

#### 7.1.7 æ‰“åŒ…ä¼˜åŒ–å»ºè®®

**1. åˆ†ææ‰“åŒ…ä½“ç§¯**:

```bash
# Viteé¡¹ç›®
npm run build -- --report

# æˆ–ä½¿ç”¨rollup-plugin-visualizer
npm install --save-dev rollup-plugin-visualizer
```

**2. ä»£ç åˆ†å‰²**:

- âœ… è·¯ç”±æ‡’åŠ è½½
- âœ… ç»„ä»¶æ‡’åŠ è½½
- âœ… ç¬¬ä¸‰æ–¹åº“åˆ†ç¦»

**3. å‹ç¼©ä¼˜åŒ–**:

- âœ… å›¾ç‰‡å‹ç¼©(TinyPNG)
- âœ… å¯ç”¨Gzipå‹ç¼©(Nginxé…ç½®)
- âœ… ç§»é™¤console.log

**4. CDNåŠ é€Ÿ**:

```javascript
// vite.config.js
export default {
  build: {
    rollupOptions: {
      external: ['react', 'react-dom'],
      output: {
        globals: {
          react: 'React',
          'react-dom': 'ReactDOM'
        }
      }
    }
  }
}
```

### 7.2 å‰ç«¯éƒ¨ç½²

```bash
# 1. æœ¬åœ°æ„å»º
npm run build
# ç”Ÿæˆdist/æ–‡ä»¶å¤¹

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r dist/* user@your-server:/var/www/mysite/

# æˆ–ä½¿ç”¨rsync
rsync -avz dist/ user@your-server:/var/www/mysite/

# 3. è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/mysite
sudo chmod -R 755 /var/www/mysite

# 4. é…ç½®Nginx
sudo vim /etc/nginx/sites-available/mysite

# 5. æµ‹è¯•å¹¶é‡è½½
sudo nginx -t
sudo nginx -s reload
```

### 7.3 åç«¯éƒ¨ç½²

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
git clone https://github.com/yourname/yourproject.git
cd yourproject

# 2. å®‰è£…ä¾èµ–
npm install --production
# æˆ– pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vim .env

# 4. ç”¨PM2å¯åŠ¨
pm2 start server.js --name my-api

# 5. é…ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# 6. æŸ¥çœ‹æ—¥å¿—
pm2 logs my-api
```

### 7.4 å®Œæ•´Nginxé…ç½®

```nginx
# /etc/nginx/sites-available/mysite

server {
    listen 80;
    server_name www.yoursite.com yoursite.com;

    # é‡å®šå‘åˆ°HTTPS
    return 301 https://www.yoursite.com$request_uri;
}

server {
    listen 443 ssl http2;
    server_name www.yoursite.com;

    # SSLè¯ä¹¦(Certbotè‡ªåŠ¨é…ç½®)
    ssl_certificate /etc/letsencrypt/live/www.yoursite.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/www.yoursite.com/privkey.pem;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/mysite/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯API
    location /api/ {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
        root /var/www/mysite/dist;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
```

---

## 8. å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: è®¿é—®åŸŸåæ˜¾ç¤º502 Bad Gateway

**åŸå› **: Nginxæ— æ³•è¿æ¥åˆ°åç«¯

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. åç«¯åº”ç”¨æ˜¯å¦è¿è¡Œ?
pm2 list

# 2. ç«¯å£æ˜¯å¦æ­£ç¡®?
netstat -tuln | grep 3000

# 3. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢?
sudo ufw status

# 4. æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# 5. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
pm2 logs my-app
```

---

### Q2: åŸŸåæ— æ³•è®¿é—®

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. DNSæ˜¯å¦è§£ææ­£ç¡®?
nslookup www.yoursite.com

# 2. æœåŠ¡å™¨IPæ˜¯å¦æ­£ç¡®?
ping www.yoursite.com

# 3. äº‘å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾80/443?
# ç™»å½•äº‘æ§åˆ¶å°æ£€æŸ¥

# 4. Nginxæ˜¯å¦è¿è¡Œ?
sudo systemctl status nginx

# 5. Nginxé…ç½®æ˜¯å¦æ­£ç¡®?
sudo nginx -t
```

---

### Q3: HTTPSè¯ä¹¦é”™è¯¯

**æ’æŸ¥**:

```bash
# 1. è¯ä¹¦æ˜¯å¦è¿‡æœŸ?
sudo certbot certificates

# 2. æ‰‹åŠ¨ç»­æœŸ
sudo certbot renew

# 3. å¼ºåˆ¶é‡æ–°è·å–
sudo certbot --nginx -d www.yoursite.com --force-renew
```

---

### Q4: PM2åº”ç”¨é‡å¯ååœæ­¢

**åŸå› **: æ²¡æœ‰é…ç½®å¼€æœºè‡ªå¯

```bash
# é‡æ–°é…ç½®
pm2 startup
# å¤åˆ¶è¾“å‡ºçš„å‘½ä»¤æ‰§è¡Œ

pm2 save

# éªŒè¯
sudo reboot
# é‡å¯åæ£€æŸ¥
pm2 list
```

---

## 9. éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰

- âœ… ä»£ç åœ¨æœ¬åœ°æµ‹è¯•é€šè¿‡
- âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- âœ… package.jsonä¾èµ–å®Œæ•´
- âœ… .gitignoreé…ç½®æ­£ç¡®

### æœåŠ¡å™¨é…ç½®

- âœ… äº‘å®‰å…¨ç»„å¼€æ”¾80/443/22ç«¯å£
- âœ… Node.js/Pythonç¯å¢ƒå·²å®‰è£…
- âœ… npm/pipé•œåƒæºå·²é…ç½®
- âœ… Nginxå·²å®‰è£…å¹¶è¿è¡Œ

### åº”ç”¨éƒ¨ç½²

- âœ… ä»£ç å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- âœ… ä¾èµ–å·²å®‰è£…(npm install/pip install)
- âœ… PM2åº”ç”¨å·²å¯åŠ¨
- âœ… PM2å¼€æœºè‡ªå¯å·²é…ç½®(startup+save)
- âœ… åº”ç”¨æ—¥å¿—æ— é”™è¯¯

### Nginxé…ç½®

- âœ… é™æ€æ–‡ä»¶è·¯å¾„æ­£ç¡®
- âœ… åå‘ä»£ç†é…ç½®æ­£ç¡®
- âœ… SPAåº”ç”¨try_filesé…ç½®
- âœ… nginx -tæµ‹è¯•é€šè¿‡
- âœ… é…ç½®å·²é‡è½½

### HTTPSé…ç½®

- âœ… SSLè¯ä¹¦å·²é…ç½®
- âœ… HTTPè‡ªåŠ¨è·³è½¬HTTPS
- âœ… æµè§ˆå™¨æ˜¾ç¤ºå®‰å…¨é”

### DNSé…ç½®

- âœ… Aè®°å½•å·²æ·»åŠ 
- âœ… DNSè§£æç”Ÿæ•ˆ
- âœ… åŸŸåå¯ä»¥è®¿é—®

---

## 10. æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **éƒ¨ç½²ä¸‰ä»¶å¥—**:
   - Nginx: å‰å°æ¥å¾…(åå‘ä»£ç†)
   - PM2: éƒ¨é—¨ç»ç†(è¿›ç¨‹ç®¡ç†)
   - äº‘å®‰å…¨ç»„: é—¨ç¦ç³»ç»Ÿ(é˜²ç«å¢™)

2. **HTTPSæ˜¯å¿…éœ€çš„**:
   - ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦
   - Certbotè‡ªåŠ¨é…ç½®
   - è‡ªåŠ¨ç»­æœŸ

3. **DNSè§£æ**:
   - Aè®°å½•æŒ‡å‘æœåŠ¡å™¨IP
   - ç­‰å¾…5åˆ†é’Ÿ-24å°æ—¶ç”Ÿæ•ˆ

4. **PM2å¿…é¡»é…ç½®å¼€æœºè‡ªå¯**:
   - `pm2 startup`
   - `pm2 save`
   - ä¸¤ä¸ªéƒ½è¦!

### å…¸å‹é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³ |
|------|------|------|
| 502 Bad Gateway | åç«¯æ²¡è¿è¡Œ | æ£€æŸ¥PM2 |
| 403 Forbidden | æƒé™ä¸å¯¹ | chown+chmod |
| æ— æ³•è®¿é—® | å®‰å…¨ç»„æ²¡å¼€ | å¼€æ”¾ç«¯å£ |
| è¯ä¹¦é”™è¯¯ | è¯ä¹¦è¿‡æœŸ | certbot renew |
| é‡å¯ååº”ç”¨åœæ­¢ | æ²¡ä¿å­˜PM2 | pm2 save |

### ä¸‹ä¸€æ­¥

æ­å–œ!ä½ å·²ç»æŒæ¡äº†å®Œæ•´çš„éƒ¨ç½²æµç¨‹ã€‚

ç»§ç»­æ·±å…¥:
- å­¦ä¹ Dockerå®¹å™¨åŒ–éƒ¨ç½²
- å­¦ä¹ CI/CDè‡ªåŠ¨åŒ–éƒ¨ç½²
- å­¦ä¹ Kubernetesé›†ç¾¤ç®¡ç†
- å­¦ä¹ ç›‘æ§å’Œæ—¥å¿—åˆ†æ

**è®°ä½**: éƒ¨ç½²å‡ºé—®é¢˜æ˜¯æ­£å¸¸çš„,é‡è¦çš„æ˜¯å­¦ä¼šçœ‹æ—¥å¿—æ’æŸ¥!
